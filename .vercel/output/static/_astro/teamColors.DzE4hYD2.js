const p="/api/nhl";async function D(){const e=await fetch(`${p}/standings/now`);if(!e.ok)throw new Error("Failed to fetch teams");const r=await e.json(),t=new Set,s=[];for(const o of r.standings){const n=o.teamAbbrev.default;t.has(n)||(t.add(n),s.push({abbreviation:n,name:o.teamName.default,commonName:o.teamCommonName.default}))}return s.sort((o,n)=>o.name.localeCompare(n.name))}async function T(e=null){const r=e?e.toISOString().split("T")[0]:"now",t=await fetch(`${p}/score/${r}`);if(!t.ok)throw new Error("Failed to fetch scores");return(await t.json()).games||[]}async function S(e){const r=await fetch(`${p}/gamecenter/${e}/play-by-play`);if(!r.ok)throw new Error("Failed to fetch play-by-play");return r.json()}function w(e){const r={};for(const t of e.plays||[]){if(t.typeDescKey!=="goal")continue;const s=t.periodDescriptor?.number,o=t.timeInPeriod,n=t.details?.shotType;s&&o&&n&&(r[`${s}-${o}`]=n)}return r}function C(e,r){if(r?.periodType==="OT")return"OT";if(r?.periodType==="SO")return"SO";switch(e){case 1:return"1st";case 2:return"2nd";case 3:return"3rd";default:return"OT"}}async function E(e,r=3){const t=[],s=new Date;for(let o=0;o<r;o++){const n=new Date(s);n.setDate(s.getDate()-o);try{const c=await T(n);for(const a of c){const d=e.has(a.homeTeam.abbrev),y=e.has(a.awayTeam.abbrev);if(!d&&!y)continue;let l={};if(a.goals?.length>0)try{const i=await S(a.id);l=w(i)}catch{}if(a.goals)for(const i of a.goals){const m=`${i.period}-${i.timeInPeriod}`,f=l[m];d&&i.teamAbbrev===a.awayTeam.abbrev?t.push(u(a,i,a.homeTeam,a.awayTeam,!0,f)):y&&i.teamAbbrev===a.homeTeam.abbrev&&t.push(u(a,i,a.awayTeam,a.homeTeam,!1,f))}if(a.gameState==="OFF"||a.gameState==="FINAL"){const i=a.homeTeam.score??0,m=a.awayTeam.score??0;d&&i<m?t.push(h(a,a.homeTeam,i,a.awayTeam,m,!0)):y&&m<i&&t.push(h(a,a.awayTeam,m,a.homeTeam,i,!1))}}}catch{}}return t.sort((o,n)=>{const c=new Date(n.timestamp)-new Date(o.timestamp);if(c!==0)return c;const a=(n.periodNumber||0)-(o.periodNumber||0);return a!==0?a:(n.periodTimeSeconds||0)-(o.periodTimeSeconds||0)})}function u(e,r,t,s,o,n){const c=r.firstName?.default&&r.lastName?.default?`${r.firstName.default} ${r.lastName.default}`:r.name?.default||"Unknown",[a,d]=(r.timeInPeriod||"0:00").split(":").map(Number),y=a*60+d;return{id:`goal-${e.id}-${r.timeInPeriod}-${r.period}`,type:"goalAgainst",teamAbbreviation:t.abbrev,teamName:t.commonName?.default||t.abbrev,opponentAbbreviation:s.abbrev,opponentName:s.commonName?.default||s.abbrev,timestamp:e.startTimeUTC,gameId:e.id,periodNumber:r.period,periodTimeSeconds:y,rivalScore:o?e.homeTeam.score??0:e.awayTeam.score??0,opponentScore:o?e.awayTeam.score??0:e.homeTeam.score??0,period:C(r.period,r.periodDescriptor),timeInPeriod:r.timeInPeriod,scorerName:c,isHomeGame:o,highlightURL:r.highlightClipSharingUrl||null,shotType:n,strength:r.strength}}function h(e,r,t,s,o,n){return{id:`loss-${e.id}`,type:"loss",teamAbbreviation:r.abbrev,teamName:r.commonName?.default||r.abbrev,opponentAbbreviation:s.abbrev,opponentName:s.commonName?.default||s.abbrev,timestamp:e.startTimeUTC,gameId:e.id,periodNumber:99,periodTimeSeconds:0,rivalScore:t,opponentScore:o,period:null,timeInPeriod:null,scorerName:null,isHomeGame:n,highlightURL:null,shotType:null,strength:null}}const F="rival-watch-rivals";function A(){if(typeof localStorage>"u")return new Set;try{const e=localStorage.getItem(F);if(e)return new Set(JSON.parse(e))}catch{}return new Set}function b(e){typeof localStorage>"u"||localStorage.setItem(F,JSON.stringify([...e]))}function g(e){const r=A();return r.has(e)?r.delete(e):r.add(e),b(r),r}function I(){const e=new Set;return b(e),e}const N={BOS:{primary:"#FFB81C",secondary:"#000000"},BUF:{primary:"#003087",secondary:"#FFB81C"},DET:{primary:"#CE1126",secondary:"#FFFFFF"},FLA:{primary:"#C8102E",secondary:"#041E42"},MTL:{primary:"#AF1E2D",secondary:"#192168"},OTT:{primary:"#C52032",secondary:"#000000"},TBL:{primary:"#002868",secondary:"#FFFFFF"},TOR:{primary:"#00205B",secondary:"#FFFFFF"},CAR:{primary:"#CC0000",secondary:"#000000"},CBJ:{primary:"#002654",secondary:"#CE1126"},NJD:{primary:"#CE1126",secondary:"#000000"},NYI:{primary:"#00539B",secondary:"#F47D30"},NYR:{primary:"#0038A8",secondary:"#CE1126"},PHI:{primary:"#F74902",secondary:"#000000"},PIT:{primary:"#FCB514",secondary:"#000000"},WSH:{primary:"#C8102E",secondary:"#041E42"},ARI:{primary:"#8C2633",secondary:"#E2D6B5"},UTA:{primary:"#8C2633",secondary:"#E2D6B5"},CHI:{primary:"#CF0A2C",secondary:"#000000"},COL:{primary:"#6F263D",secondary:"#236192"},DAL:{primary:"#006847",secondary:"#8F8F8C"},MIN:{primary:"#154734",secondary:"#DDCBA4"},NSH:{primary:"#FFB81C",secondary:"#041E42"},STL:{primary:"#002F87",secondary:"#FCB514"},WPG:{primary:"#041E42",secondary:"#004C97"},ANA:{primary:"#F47A38",secondary:"#000000"},CGY:{primary:"#D2001C",secondary:"#FAAF19"},EDM:{primary:"#041E42",secondary:"#FF4C00"},LAK:{primary:"#111111",secondary:"#A2AAAD"},SJS:{primary:"#006D75",secondary:"#000000"},SEA:{primary:"#001628",secondary:"#99D9D9"},VAN:{primary:"#00205B",secondary:"#00843D"},VGK:{primary:"#B4975A",secondary:"#333F42"}};function B(e){return N[e?.toUpperCase()]||{primary:"#666666",secondary:"#000000"}}const O="#E53935";export{O as a,A as b,I as c,D as d,E as f,B as g,g as t};
